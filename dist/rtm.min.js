var RTMClient=function(t){var e={};function n(r){if(e[r])return e[r].exports;var i=e[r]={i:r,l:!1,exports:{}};return t[r].call(i.exports,i,i.exports,n),i.l=!0,i.exports}return n.m=t,n.c=e,n.d=function(t,e,r){n.o(t,e)||Object.defineProperty(t,e,{configurable:!1,enumerable:!0,get:r})},n.r=function(t){Object.defineProperty(t,"__esModule",{value:!0})},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=19)}([function(t,e,n){"use strict";var r=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}();var i=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}return r(t,null,[{key:"assign",value:function(t){if(!t||t.hasOwnProperty("events"))throw new Error(t+" is null or hasOwnProperty [ events ]");if(t.hasOwnProperty("on")||t.hasOwnProperty("emit")||t.hasOwnProperty("removeEvent"))throw new Error(t+" hasOwnProperty [ on | emit | removeEvent | listenerCount]");t.events={},t.on=function(e,n){t.events.hasOwnProperty(e)||(t.events[e]=[]),-1==t.events[e].indexOf(n)&&t.events[e].push(n)},t.emit=function(){if(0!=arguments.length)for(var e=t.events[arguments[0]]||[],n=0;n<e.length;n++){var r=e[n];if(r){for(var i=[],o=1;o<arguments.length;o++)i[o-1]=arguments[o];r.apply(t,i)}}},t.removeEvent=function(){if(0!=arguments.length)if(1!=arguments.length){var e=arguments[0],n=t.events[e].indexOf(arguments[1]);n>-1&&t.events[e].splice(n,1)}else{var r=arguments[0];t.events.hasOwnProperty(r)&&delete t.events[r]}else t.events={}},t.listenerCount=function(e){return t.events.hasOwnProperty(e)?(t.events[e]||[]).length:0}}}]),t}();t.exports=i},function(t,e,n){"use strict";var r=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}();var i=n(2).Buffer,o={FPNN_EC_PROTO_UNKNOWN_ERROR:10001,FPNN_EC_PROTO_NOT_SUPPORTED:10002,FPNN_EC_PROTO_INVALID_PACKAGE:10003,FPNN_EC_PROTO_JSON_CONVERT:10004,FPNN_EC_PROTO_STRING_KEY:10005,FPNN_EC_PROTO_MAP_VALUE:10006,FPNN_EC_PROTO_METHOD_TYPE:10007,FPNN_EC_PROTO_PROTO_TYPE:10008,FPNN_EC_PROTO_KEY_NOT_FOUND:10009,FPNN_EC_PROTO_TYPE_CONVERT:10010,FPNN_EC_CORE_UNKNOWN_ERROR:20001,FPNN_EC_CORE_CONNECTION_CLOSED:20002,FPNN_EC_CORE_TIMEOUT:20003,FPNN_EC_CORE_UNKNOWN_METHOD:20004,FPNN_EC_CORE_ENCODING:20005,FPNN_EC_CORE_DECODING:20006,FPNN_EC_CORE_SEND_ERROR:20007,FPNN_EC_CORE_RECV_ERROR:20008,FPNN_EC_CORE_INVALID_PACKAGE:20009,FPNN_EC_CORE_HTTP_ERROR:20010,FPNN_EC_CORE_WORK_QUEUE_FULL:20011,FPNN_EC_CORE_INVALID_CONNECTION:20012,FPNN_EC_CORE_FORBIDDEN:20013,FPNN_EC_CORE_SERVER_STOPPING:20014},s=i.from([0,1]),a=i.from([64,128]),u=i.from([0,1,2]),c=i.from("FPNN"),f=i.from("POST"),l=["secp256k1","secp224r1"],h=["aes-128-cfb","aes-256-cfb"],p=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}return r(t,null,[{key:"ERROR_CODE",get:function(){return o}},{key:"FP_FLAG",get:function(){return a}},{key:"FP_MESSAGE_TYPE",get:function(){return u}},{key:"TCP_MAGIC",get:function(){return c}},{key:"HTTP_MAGIC",get:function(){return f}},{key:"FPNN_VERSION",get:function(){return s}},{key:"READ_BUFFER_LEN",get:function(){return 1024}},{key:"CHECK_CBS_INTERVAL",get:function(){return 1e3}},{key:"SEND_TIMEOUT",get:function(){return 2e4}},{key:"CRYPTO_CURVES",get:function(){return l}},{key:"CRYPTO_ALGORITHM",get:function(){return h}}]),t}();t.exports=p},function(t,e,n){"use strict";(function(t){var r=n(18),i=n(17),o=n(16);function s(){return u.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function a(t,e){if(s()<e)throw new RangeError("Invalid typed array length");return u.TYPED_ARRAY_SUPPORT?(t=new Uint8Array(e)).__proto__=u.prototype:(null===t&&(t=new u(e)),t.length=e),t}function u(t,e,n){if(!(u.TYPED_ARRAY_SUPPORT||this instanceof u))return new u(t,e,n);if("number"==typeof t){if("string"==typeof e)throw new Error("If encoding is specified then the first argument must be a string");return l(this,t)}return c(this,t,e,n)}function c(t,e,n,r){if("number"==typeof e)throw new TypeError('"value" argument must not be a number');return"undefined"!=typeof ArrayBuffer&&e instanceof ArrayBuffer?function(t,e,n,r){if(e.byteLength,n<0||e.byteLength<n)throw new RangeError("'offset' is out of bounds");if(e.byteLength<n+(r||0))throw new RangeError("'length' is out of bounds");e=void 0===n&&void 0===r?new Uint8Array(e):void 0===r?new Uint8Array(e,n):new Uint8Array(e,n,r);u.TYPED_ARRAY_SUPPORT?(t=e).__proto__=u.prototype:t=h(t,e);return t}(t,e,n,r):"string"==typeof e?function(t,e,n){"string"==typeof n&&""!==n||(n="utf8");if(!u.isEncoding(n))throw new TypeError('"encoding" must be a valid string encoding');var r=0|_(e,n),i=(t=a(t,r)).write(e,n);i!==r&&(t=t.slice(0,i));return t}(t,e,n):function(t,e){if(u.isBuffer(e)){var n=0|p(e.length);return 0===(t=a(t,n)).length?t:(e.copy(t,0,0,n),t)}if(e){if("undefined"!=typeof ArrayBuffer&&e.buffer instanceof ArrayBuffer||"length"in e)return"number"!=typeof e.length||(r=e.length)!=r?a(t,0):h(t,e);if("Buffer"===e.type&&o(e.data))return h(t,e.data)}var r;throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")}(t,e)}function f(t){if("number"!=typeof t)throw new TypeError('"size" argument must be a number');if(t<0)throw new RangeError('"size" argument must not be negative')}function l(t,e){if(f(e),t=a(t,e<0?0:0|p(e)),!u.TYPED_ARRAY_SUPPORT)for(var n=0;n<e;++n)t[n]=0;return t}function h(t,e){var n=e.length<0?0:0|p(e.length);t=a(t,n);for(var r=0;r<n;r+=1)t[r]=255&e[r];return t}function p(t){if(t>=s())throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+s().toString(16)+" bytes");return 0|t}function _(t,e){if(u.isBuffer(t))return t.length;if("undefined"!=typeof ArrayBuffer&&"function"==typeof ArrayBuffer.isView&&(ArrayBuffer.isView(t)||t instanceof ArrayBuffer))return t.byteLength;"string"!=typeof t&&(t=""+t);var n=t.length;if(0===n)return 0;for(var r=!1;;)switch(e){case"ascii":case"latin1":case"binary":return n;case"utf8":case"utf-8":case void 0:return L(t).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*n;case"hex":return n>>>1;case"base64":return Y(t).length;default:if(r)return L(t).length;e=(""+e).toLowerCase(),r=!0}}function d(t,e,n){var r=t[e];t[e]=t[n],t[n]=r}function g(t,e,n,r,i){if(0===t.length)return-1;if("string"==typeof n?(r=n,n=0):n>2147483647?n=2147483647:n<-2147483648&&(n=-2147483648),n=+n,isNaN(n)&&(n=i?0:t.length-1),n<0&&(n=t.length+n),n>=t.length){if(i)return-1;n=t.length-1}else if(n<0){if(!i)return-1;n=0}if("string"==typeof e&&(e=u.from(e,r)),u.isBuffer(e))return 0===e.length?-1:m(t,e,n,r,i);if("number"==typeof e)return e&=255,u.TYPED_ARRAY_SUPPORT&&"function"==typeof Uint8Array.prototype.indexOf?i?Uint8Array.prototype.indexOf.call(t,e,n):Uint8Array.prototype.lastIndexOf.call(t,e,n):m(t,[e],n,r,i);throw new TypeError("val must be string, number or Buffer")}function m(t,e,n,r,i){var o,s=1,a=t.length,u=e.length;if(void 0!==r&&("ucs2"===(r=String(r).toLowerCase())||"ucs-2"===r||"utf16le"===r||"utf-16le"===r)){if(t.length<2||e.length<2)return-1;s=2,a/=2,u/=2,n/=2}function c(t,e){return 1===s?t[e]:t.readUInt16BE(e*s)}if(i){var f=-1;for(o=n;o<a;o++)if(c(t,o)===c(e,-1===f?0:o-f)){if(-1===f&&(f=o),o-f+1===u)return f*s}else-1!==f&&(o-=o-f),f=-1}else for(n+u>a&&(n=a-u),o=n;o>=0;o--){for(var l=!0,h=0;h<u;h++)if(c(t,o+h)!==c(e,h)){l=!1;break}if(l)return o}return-1}function y(t,e,n,r){n=Number(n)||0;var i=t.length-n;r?(r=Number(r))>i&&(r=i):r=i;var o=e.length;if(o%2!=0)throw new TypeError("Invalid hex string");r>o/2&&(r=o/2);for(var s=0;s<r;++s){var a=parseInt(e.substr(2*s,2),16);if(isNaN(a))return s;t[n+s]=a}return s}function v(t,e,n,r){return G(L(e,t.length-n),t,n,r)}function E(t,e,n,r){return G(function(t){for(var e=[],n=0;n<t.length;++n)e.push(255&t.charCodeAt(n));return e}(e),t,n,r)}function w(t,e,n,r){return E(t,e,n,r)}function R(t,e,n,r){return G(Y(e),t,n,r)}function C(t,e,n,r){return G(function(t,e){for(var n,r,i,o=[],s=0;s<t.length&&!((e-=2)<0);++s)n=t.charCodeAt(s),r=n>>8,i=n%256,o.push(i),o.push(r);return o}(e,t.length-n),t,n,r)}function b(t,e,n){return 0===e&&n===t.length?r.fromByteArray(t):r.fromByteArray(t.slice(e,n))}function O(t,e,n){n=Math.min(t.length,n);for(var r=[],i=e;i<n;){var o,s,a,u,c=t[i],f=null,l=c>239?4:c>223?3:c>191?2:1;if(i+l<=n)switch(l){case 1:c<128&&(f=c);break;case 2:128==(192&(o=t[i+1]))&&(u=(31&c)<<6|63&o)>127&&(f=u);break;case 3:o=t[i+1],s=t[i+2],128==(192&o)&&128==(192&s)&&(u=(15&c)<<12|(63&o)<<6|63&s)>2047&&(u<55296||u>57343)&&(f=u);break;case 4:o=t[i+1],s=t[i+2],a=t[i+3],128==(192&o)&&128==(192&s)&&128==(192&a)&&(u=(15&c)<<18|(63&o)<<12|(63&s)<<6|63&a)>65535&&u<1114112&&(f=u)}null===f?(f=65533,l=1):f>65535&&(f-=65536,r.push(f>>>10&1023|55296),f=56320|1023&f),r.push(f),i+=l}return function(t){var e=t.length;if(e<=T)return String.fromCharCode.apply(String,t);var n="",r=0;for(;r<e;)n+=String.fromCharCode.apply(String,t.slice(r,r+=T));return n}(r)}e.Buffer=u,e.SlowBuffer=function(t){+t!=t&&(t=0);return u.alloc(+t)},e.INSPECT_MAX_BYTES=50,u.TYPED_ARRAY_SUPPORT=void 0!==t.TYPED_ARRAY_SUPPORT?t.TYPED_ARRAY_SUPPORT:function(){try{var t=new Uint8Array(1);return t.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},42===t.foo()&&"function"==typeof t.subarray&&0===t.subarray(1,1).byteLength}catch(t){return!1}}(),e.kMaxLength=s(),u.poolSize=8192,u._augment=function(t){return t.__proto__=u.prototype,t},u.from=function(t,e,n){return c(null,t,e,n)},u.TYPED_ARRAY_SUPPORT&&(u.prototype.__proto__=Uint8Array.prototype,u.__proto__=Uint8Array,"undefined"!=typeof Symbol&&Symbol.species&&u[Symbol.species]===u&&Object.defineProperty(u,Symbol.species,{value:null,configurable:!0})),u.alloc=function(t,e,n){return function(t,e,n,r){return f(e),e<=0?a(t,e):void 0!==n?"string"==typeof r?a(t,e).fill(n,r):a(t,e).fill(n):a(t,e)}(null,t,e,n)},u.allocUnsafe=function(t){return l(null,t)},u.allocUnsafeSlow=function(t){return l(null,t)},u.isBuffer=function(t){return!(null==t||!t._isBuffer)},u.compare=function(t,e){if(!u.isBuffer(t)||!u.isBuffer(e))throw new TypeError("Arguments must be Buffers");if(t===e)return 0;for(var n=t.length,r=e.length,i=0,o=Math.min(n,r);i<o;++i)if(t[i]!==e[i]){n=t[i],r=e[i];break}return n<r?-1:r<n?1:0},u.isEncoding=function(t){switch(String(t).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},u.concat=function(t,e){if(!o(t))throw new TypeError('"list" argument must be an Array of Buffers');if(0===t.length)return u.alloc(0);var n;if(void 0===e)for(e=0,n=0;n<t.length;++n)e+=t[n].length;var r=u.allocUnsafe(e),i=0;for(n=0;n<t.length;++n){var s=t[n];if(!u.isBuffer(s))throw new TypeError('"list" argument must be an Array of Buffers');s.copy(r,i),i+=s.length}return r},u.byteLength=_,u.prototype._isBuffer=!0,u.prototype.swap16=function(){var t=this.length;if(t%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var e=0;e<t;e+=2)d(this,e,e+1);return this},u.prototype.swap32=function(){var t=this.length;if(t%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var e=0;e<t;e+=4)d(this,e,e+3),d(this,e+1,e+2);return this},u.prototype.swap64=function(){var t=this.length;if(t%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var e=0;e<t;e+=8)d(this,e,e+7),d(this,e+1,e+6),d(this,e+2,e+5),d(this,e+3,e+4);return this},u.prototype.toString=function(){var t=0|this.length;return 0===t?"":0===arguments.length?O(this,0,t):function(t,e,n){var r=!1;if((void 0===e||e<0)&&(e=0),e>this.length)return"";if((void 0===n||n>this.length)&&(n=this.length),n<=0)return"";if((n>>>=0)<=(e>>>=0))return"";for(t||(t="utf8");;)switch(t){case"hex":return P(this,e,n);case"utf8":case"utf-8":return O(this,e,n);case"ascii":return k(this,e,n);case"latin1":case"binary":return A(this,e,n);case"base64":return b(this,e,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return I(this,e,n);default:if(r)throw new TypeError("Unknown encoding: "+t);t=(t+"").toLowerCase(),r=!0}}.apply(this,arguments)},u.prototype.equals=function(t){if(!u.isBuffer(t))throw new TypeError("Argument must be a Buffer");return this===t||0===u.compare(this,t)},u.prototype.inspect=function(){var t="",n=e.INSPECT_MAX_BYTES;return this.length>0&&(t=this.toString("hex",0,n).match(/.{2}/g).join(" "),this.length>n&&(t+=" ... ")),"<Buffer "+t+">"},u.prototype.compare=function(t,e,n,r,i){if(!u.isBuffer(t))throw new TypeError("Argument must be a Buffer");if(void 0===e&&(e=0),void 0===n&&(n=t?t.length:0),void 0===r&&(r=0),void 0===i&&(i=this.length),e<0||n>t.length||r<0||i>this.length)throw new RangeError("out of range index");if(r>=i&&e>=n)return 0;if(r>=i)return-1;if(e>=n)return 1;if(e>>>=0,n>>>=0,r>>>=0,i>>>=0,this===t)return 0;for(var o=i-r,s=n-e,a=Math.min(o,s),c=this.slice(r,i),f=t.slice(e,n),l=0;l<a;++l)if(c[l]!==f[l]){o=c[l],s=f[l];break}return o<s?-1:s<o?1:0},u.prototype.includes=function(t,e,n){return-1!==this.indexOf(t,e,n)},u.prototype.indexOf=function(t,e,n){return g(this,t,e,n,!0)},u.prototype.lastIndexOf=function(t,e,n){return g(this,t,e,n,!1)},u.prototype.write=function(t,e,n,r){if(void 0===e)r="utf8",n=this.length,e=0;else if(void 0===n&&"string"==typeof e)r=e,n=this.length,e=0;else{if(!isFinite(e))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");e|=0,isFinite(n)?(n|=0,void 0===r&&(r="utf8")):(r=n,n=void 0)}var i=this.length-e;if((void 0===n||n>i)&&(n=i),t.length>0&&(n<0||e<0)||e>this.length)throw new RangeError("Attempt to write outside buffer bounds");r||(r="utf8");for(var o=!1;;)switch(r){case"hex":return y(this,t,e,n);case"utf8":case"utf-8":return v(this,t,e,n);case"ascii":return E(this,t,e,n);case"latin1":case"binary":return w(this,t,e,n);case"base64":return R(this,t,e,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return C(this,t,e,n);default:if(o)throw new TypeError("Unknown encoding: "+r);r=(""+r).toLowerCase(),o=!0}},u.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var T=4096;function k(t,e,n){var r="";n=Math.min(t.length,n);for(var i=e;i<n;++i)r+=String.fromCharCode(127&t[i]);return r}function A(t,e,n){var r="";n=Math.min(t.length,n);for(var i=e;i<n;++i)r+=String.fromCharCode(t[i]);return r}function P(t,e,n){var r=t.length;(!e||e<0)&&(e=0),(!n||n<0||n>r)&&(n=r);for(var i="",o=e;o<n;++o)i+=x(t[o]);return i}function I(t,e,n){for(var r=t.slice(e,n),i="",o=0;o<r.length;o+=2)i+=String.fromCharCode(r[o]+256*r[o+1]);return i}function S(t,e,n){if(t%1!=0||t<0)throw new RangeError("offset is not uint");if(t+e>n)throw new RangeError("Trying to access beyond buffer length")}function M(t,e,n,r,i,o){if(!u.isBuffer(t))throw new TypeError('"buffer" argument must be a Buffer instance');if(e>i||e<o)throw new RangeError('"value" argument is out of bounds');if(n+r>t.length)throw new RangeError("Index out of range")}function N(t,e,n,r){e<0&&(e=65535+e+1);for(var i=0,o=Math.min(t.length-n,2);i<o;++i)t[n+i]=(e&255<<8*(r?i:1-i))>>>8*(r?i:1-i)}function B(t,e,n,r){e<0&&(e=4294967295+e+1);for(var i=0,o=Math.min(t.length-n,4);i<o;++i)t[n+i]=e>>>8*(r?i:3-i)&255}function D(t,e,n,r,i,o){if(n+r>t.length)throw new RangeError("Index out of range");if(n<0)throw new RangeError("Index out of range")}function U(t,e,n,r,o){return o||D(t,0,n,4),i.write(t,e,n,r,23,4),n+4}function H(t,e,n,r,o){return o||D(t,0,n,8),i.write(t,e,n,r,52,8),n+8}u.prototype.slice=function(t,e){var n,r=this.length;if(t=~~t,e=void 0===e?r:~~e,t<0?(t+=r)<0&&(t=0):t>r&&(t=r),e<0?(e+=r)<0&&(e=0):e>r&&(e=r),e<t&&(e=t),u.TYPED_ARRAY_SUPPORT)(n=this.subarray(t,e)).__proto__=u.prototype;else{var i=e-t;n=new u(i,void 0);for(var o=0;o<i;++o)n[o]=this[o+t]}return n},u.prototype.readUIntLE=function(t,e,n){t|=0,e|=0,n||S(t,e,this.length);for(var r=this[t],i=1,o=0;++o<e&&(i*=256);)r+=this[t+o]*i;return r},u.prototype.readUIntBE=function(t,e,n){t|=0,e|=0,n||S(t,e,this.length);for(var r=this[t+--e],i=1;e>0&&(i*=256);)r+=this[t+--e]*i;return r},u.prototype.readUInt8=function(t,e){return e||S(t,1,this.length),this[t]},u.prototype.readUInt16LE=function(t,e){return e||S(t,2,this.length),this[t]|this[t+1]<<8},u.prototype.readUInt16BE=function(t,e){return e||S(t,2,this.length),this[t]<<8|this[t+1]},u.prototype.readUInt32LE=function(t,e){return e||S(t,4,this.length),(this[t]|this[t+1]<<8|this[t+2]<<16)+16777216*this[t+3]},u.prototype.readUInt32BE=function(t,e){return e||S(t,4,this.length),16777216*this[t]+(this[t+1]<<16|this[t+2]<<8|this[t+3])},u.prototype.readIntLE=function(t,e,n){t|=0,e|=0,n||S(t,e,this.length);for(var r=this[t],i=1,o=0;++o<e&&(i*=256);)r+=this[t+o]*i;return r>=(i*=128)&&(r-=Math.pow(2,8*e)),r},u.prototype.readIntBE=function(t,e,n){t|=0,e|=0,n||S(t,e,this.length);for(var r=e,i=1,o=this[t+--r];r>0&&(i*=256);)o+=this[t+--r]*i;return o>=(i*=128)&&(o-=Math.pow(2,8*e)),o},u.prototype.readInt8=function(t,e){return e||S(t,1,this.length),128&this[t]?-1*(255-this[t]+1):this[t]},u.prototype.readInt16LE=function(t,e){e||S(t,2,this.length);var n=this[t]|this[t+1]<<8;return 32768&n?4294901760|n:n},u.prototype.readInt16BE=function(t,e){e||S(t,2,this.length);var n=this[t+1]|this[t]<<8;return 32768&n?4294901760|n:n},u.prototype.readInt32LE=function(t,e){return e||S(t,4,this.length),this[t]|this[t+1]<<8|this[t+2]<<16|this[t+3]<<24},u.prototype.readInt32BE=function(t,e){return e||S(t,4,this.length),this[t]<<24|this[t+1]<<16|this[t+2]<<8|this[t+3]},u.prototype.readFloatLE=function(t,e){return e||S(t,4,this.length),i.read(this,t,!0,23,4)},u.prototype.readFloatBE=function(t,e){return e||S(t,4,this.length),i.read(this,t,!1,23,4)},u.prototype.readDoubleLE=function(t,e){return e||S(t,8,this.length),i.read(this,t,!0,52,8)},u.prototype.readDoubleBE=function(t,e){return e||S(t,8,this.length),i.read(this,t,!1,52,8)},u.prototype.writeUIntLE=function(t,e,n,r){(t=+t,e|=0,n|=0,r)||M(this,t,e,n,Math.pow(2,8*n)-1,0);var i=1,o=0;for(this[e]=255&t;++o<n&&(i*=256);)this[e+o]=t/i&255;return e+n},u.prototype.writeUIntBE=function(t,e,n,r){(t=+t,e|=0,n|=0,r)||M(this,t,e,n,Math.pow(2,8*n)-1,0);var i=n-1,o=1;for(this[e+i]=255&t;--i>=0&&(o*=256);)this[e+i]=t/o&255;return e+n},u.prototype.writeUInt8=function(t,e,n){return t=+t,e|=0,n||M(this,t,e,1,255,0),u.TYPED_ARRAY_SUPPORT||(t=Math.floor(t)),this[e]=255&t,e+1},u.prototype.writeUInt16LE=function(t,e,n){return t=+t,e|=0,n||M(this,t,e,2,65535,0),u.TYPED_ARRAY_SUPPORT?(this[e]=255&t,this[e+1]=t>>>8):N(this,t,e,!0),e+2},u.prototype.writeUInt16BE=function(t,e,n){return t=+t,e|=0,n||M(this,t,e,2,65535,0),u.TYPED_ARRAY_SUPPORT?(this[e]=t>>>8,this[e+1]=255&t):N(this,t,e,!1),e+2},u.prototype.writeUInt32LE=function(t,e,n){return t=+t,e|=0,n||M(this,t,e,4,4294967295,0),u.TYPED_ARRAY_SUPPORT?(this[e+3]=t>>>24,this[e+2]=t>>>16,this[e+1]=t>>>8,this[e]=255&t):B(this,t,e,!0),e+4},u.prototype.writeUInt32BE=function(t,e,n){return t=+t,e|=0,n||M(this,t,e,4,4294967295,0),u.TYPED_ARRAY_SUPPORT?(this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=255&t):B(this,t,e,!1),e+4},u.prototype.writeIntLE=function(t,e,n,r){if(t=+t,e|=0,!r){var i=Math.pow(2,8*n-1);M(this,t,e,n,i-1,-i)}var o=0,s=1,a=0;for(this[e]=255&t;++o<n&&(s*=256);)t<0&&0===a&&0!==this[e+o-1]&&(a=1),this[e+o]=(t/s>>0)-a&255;return e+n},u.prototype.writeIntBE=function(t,e,n,r){if(t=+t,e|=0,!r){var i=Math.pow(2,8*n-1);M(this,t,e,n,i-1,-i)}var o=n-1,s=1,a=0;for(this[e+o]=255&t;--o>=0&&(s*=256);)t<0&&0===a&&0!==this[e+o+1]&&(a=1),this[e+o]=(t/s>>0)-a&255;return e+n},u.prototype.writeInt8=function(t,e,n){return t=+t,e|=0,n||M(this,t,e,1,127,-128),u.TYPED_ARRAY_SUPPORT||(t=Math.floor(t)),t<0&&(t=255+t+1),this[e]=255&t,e+1},u.prototype.writeInt16LE=function(t,e,n){return t=+t,e|=0,n||M(this,t,e,2,32767,-32768),u.TYPED_ARRAY_SUPPORT?(this[e]=255&t,this[e+1]=t>>>8):N(this,t,e,!0),e+2},u.prototype.writeInt16BE=function(t,e,n){return t=+t,e|=0,n||M(this,t,e,2,32767,-32768),u.TYPED_ARRAY_SUPPORT?(this[e]=t>>>8,this[e+1]=255&t):N(this,t,e,!1),e+2},u.prototype.writeInt32LE=function(t,e,n){return t=+t,e|=0,n||M(this,t,e,4,2147483647,-2147483648),u.TYPED_ARRAY_SUPPORT?(this[e]=255&t,this[e+1]=t>>>8,this[e+2]=t>>>16,this[e+3]=t>>>24):B(this,t,e,!0),e+4},u.prototype.writeInt32BE=function(t,e,n){return t=+t,e|=0,n||M(this,t,e,4,2147483647,-2147483648),t<0&&(t=4294967295+t+1),u.TYPED_ARRAY_SUPPORT?(this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=255&t):B(this,t,e,!1),e+4},u.prototype.writeFloatLE=function(t,e,n){return U(this,t,e,!0,n)},u.prototype.writeFloatBE=function(t,e,n){return U(this,t,e,!1,n)},u.prototype.writeDoubleLE=function(t,e,n){return H(this,t,e,!0,n)},u.prototype.writeDoubleBE=function(t,e,n){return H(this,t,e,!1,n)},u.prototype.copy=function(t,e,n,r){if(n||(n=0),r||0===r||(r=this.length),e>=t.length&&(e=t.length),e||(e=0),r>0&&r<n&&(r=n),r===n)return 0;if(0===t.length||0===this.length)return 0;if(e<0)throw new RangeError("targetStart out of bounds");if(n<0||n>=this.length)throw new RangeError("sourceStart out of bounds");if(r<0)throw new RangeError("sourceEnd out of bounds");r>this.length&&(r=this.length),t.length-e<r-n&&(r=t.length-e+n);var i,o=r-n;if(this===t&&n<e&&e<r)for(i=o-1;i>=0;--i)t[i+e]=this[i+n];else if(o<1e3||!u.TYPED_ARRAY_SUPPORT)for(i=0;i<o;++i)t[i+e]=this[i+n];else Uint8Array.prototype.set.call(t,this.subarray(n,n+o),e);return o},u.prototype.fill=function(t,e,n,r){if("string"==typeof t){if("string"==typeof e?(r=e,e=0,n=this.length):"string"==typeof n&&(r=n,n=this.length),1===t.length){var i=t.charCodeAt(0);i<256&&(t=i)}if(void 0!==r&&"string"!=typeof r)throw new TypeError("encoding must be a string");if("string"==typeof r&&!u.isEncoding(r))throw new TypeError("Unknown encoding: "+r)}else"number"==typeof t&&(t&=255);if(e<0||this.length<e||this.length<n)throw new RangeError("Out of range index");if(n<=e)return this;var o;if(e>>>=0,n=void 0===n?this.length:n>>>0,t||(t=0),"number"==typeof t)for(o=e;o<n;++o)this[o]=t;else{var s=u.isBuffer(t)?t:L(new u(t,r).toString()),a=s.length;for(o=0;o<n-e;++o)this[o+e]=s[o%a]}return this};var F=/[^+\/0-9A-Za-z-_]/g;function x(t){return t<16?"0"+t.toString(16):t.toString(16)}function L(t,e){var n;e=e||1/0;for(var r=t.length,i=null,o=[],s=0;s<r;++s){if((n=t.charCodeAt(s))>55295&&n<57344){if(!i){if(n>56319){(e-=3)>-1&&o.push(239,191,189);continue}if(s+1===r){(e-=3)>-1&&o.push(239,191,189);continue}i=n;continue}if(n<56320){(e-=3)>-1&&o.push(239,191,189),i=n;continue}n=65536+(i-55296<<10|n-56320)}else i&&(e-=3)>-1&&o.push(239,191,189);if(i=null,n<128){if((e-=1)<0)break;o.push(n)}else if(n<2048){if((e-=2)<0)break;o.push(n>>6|192,63&n|128)}else if(n<65536){if((e-=3)<0)break;o.push(n>>12|224,n>>6&63|128,63&n|128)}else{if(!(n<1114112))throw new Error("Invalid code point");if((e-=4)<0)break;o.push(n>>18|240,n>>12&63|128,n>>6&63|128,63&n|128)}}return o}function Y(t){return r.toByteArray(function(t){if((t=function(t){return t.trim?t.trim():t.replace(/^\s+|\s+$/g,"")}(t).replace(F,"")).length<2)return"";for(;t.length%4!=0;)t+="=";return t}(t))}function G(t,e,n,r){for(var i=0;i<r&&!(i+n>=e.length||i>=t.length);++i)e[i+n]=t[i];return i}}).call(this,n(4))},function(t,e,n){"use strict";var r=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}();var i={RTM_EC_INVALID_PROJECT_ID_OR_USER_ID:200001,RTM_EC_INVALID_PROJECT_ID_OR_SIGN:200002,RTM_EC_INVALID_FILE_OR_SIGN_OR_TOKEN:200003,RTM_EC_ATTRS_WITHOUT_SIGN_OR_EXT:200004,RTM_EC_API_FREQUENCY_LIMITED:200010,RTM_EC_MESSAGE_FREQUENCY_LIMITED:200011,RTM_EC_FORBIDDEN_METHOD:200020,RTM_EC_PERMISSION_DENIED:200021,RTM_EC_UNAUTHORIZED:200022,RTM_EC_DUPLCATED_AUTH:200023,RTM_EC_AUTH_DENIED:200024,RTM_EC_ADMIN_LOGIN:200025,RTM_EC_ADMIN_ONLY:200026,RTM_EC_LARGE_MESSAGE_OR_ATTRS:200030,RTM_EC_LARGE_FILE_OR_ATTRS:200031,RTM_EC_TOO_MANY_ITEMS_IN_PARAMETERS:200032,RTM_EC_EMPTY_PARAMETER:200033,RTM_EC_NOT_IN_ROOM:200040,RTM_EC_NOT_GROUP_MEMBER:200041,RTM_EC_MAX_GROUP_MEMBER_COUNT:200042,RTM_EC_NOT_FRIEND:200043,RTM_EC_BANNED_IN_GROUP:200044,RTM_EC_BANNED_IN_ROOM:200045,RTM_EC_EMPTY_GROUP:200046,RTM_EC_ENTER_TOO_MANY_ROOMS:200047,RTM_EC_UNSUPPORTED_LANGUAGE:200050,RTM_EC_EMPTY_TRANSLATION:200051,RTM_EC_SEND_TO_SELF:200052,RTM_EC_DUPLCATED_MID:200053,RTM_EC_SENSITIVE_WORDS:200054,RTM_EC_UNKNOWN_ERROR:200999},o={message:0,image:10,audio:11,video:12,file:100},s={kickOut:"kickout",kickOutRoom:"kickoutroom",recvMessage:"pushmsg",recvGroupMessage:"pushgroupmsg",recvRoomMessage:"pushroommsg",recvBroadcastMessage:"pushbroadcastmsg",recvFile:"pushfile",recvGroupFile:"pushgroupfile",recvRoomFile:"pushroomfile",recvBroadcastFile:"pushbroadcastfile",recvTranslatedMessage:"transmsg",recvTranslatedGroupMessage:"transgroupmsg",recvTranslatedRoomMessage:"transroommsg",recvTranslatedBroadcastMessage:"transbroadcastmsg",recvUnreadMsgStatus:"pushunread",recvPing:"ping"},a=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}return r(t,null,[{key:"ERROR_CODE",get:function(){return i}},{key:"FILE_TYPE",get:function(){return o}},{key:"SERVER_PUSH",get:function(){return s}},{key:"MID_TTL",get:function(){return 5e3}}]),t}();t.exports=a},function(t,e){var n;n=function(){return this}();try{n=n||Function("return this")()||(0,eval)("this")}catch(t){"object"==typeof window&&(n=window)}t.exports=n},function(t,e){(function(e){t.exports=e}).call(this,{})},function(t,e){t.exports=function(t){return t.webpackPolyfill||(t.deprecate=function(){},t.paths=[],t.children||(t.children=[]),Object.defineProperty(t,"loaded",{enumerable:!0,get:function(){return t.l}}),Object.defineProperty(t,"id",{enumerable:!0,get:function(){return t.i}}),t.webpackPolyfill=1),t}},function(t,e){var n,r,i=t.exports={};function o(){throw new Error("setTimeout has not been defined")}function s(){throw new Error("clearTimeout has not been defined")}function a(t){if(n===setTimeout)return setTimeout(t,0);if((n===o||!n)&&setTimeout)return n=setTimeout,setTimeout(t,0);try{return n(t,0)}catch(e){try{return n.call(null,t,0)}catch(e){return n.call(this,t,0)}}}!function(){try{n="function"==typeof setTimeout?setTimeout:o}catch(t){n=o}try{r="function"==typeof clearTimeout?clearTimeout:s}catch(t){r=s}}();var u,c=[],f=!1,l=-1;function h(){f&&u&&(f=!1,u.length?c=u.concat(c):l=-1,c.length&&p())}function p(){if(!f){var t=a(h);f=!0;for(var e=c.length;e;){for(u=c,c=[];++l<e;)u&&u[l].run();l=-1,e=c.length}u=null,f=!1,function(t){if(r===clearTimeout)return clearTimeout(t);if((r===s||!r)&&clearTimeout)return r=clearTimeout,clearTimeout(t);try{r(t)}catch(e){try{return r.call(null,t)}catch(e){return r.call(this,t)}}}(t)}}function _(t,e){this.fun=t,this.array=e}function d(){}i.nextTick=function(t){var e=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)e[n-1]=arguments[n];c.push(new _(t,e)),1!==c.length||f||a(p)},_.prototype.run=function(){this.fun.apply(null,this.array)},i.title="browser",i.browser=!0,i.env={},i.argv=[],i.version="",i.versions={},i.on=d,i.addListener=d,i.once=d,i.off=d,i.removeListener=d,i.removeAllListeners=d,i.emit=d,i.prependListener=d,i.prependOnceListener=d,i.listeners=function(t){return[]},i.binding=function(t){throw new Error("process.binding is not supported")},i.cwd=function(){return"/"},i.chdir=function(t){throw new Error("process.chdir is not supported")},i.umask=function(){return 0}},function(module,exports,__webpack_require__){"use strict";(function(process,global,module){var __WEBPACK_AMD_DEFINE_RESULT__,_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};!function(){var ERROR="input is invalid type",WINDOW="object"===("undefined"==typeof window?"undefined":_typeof(window)),root=WINDOW?window:{};root.JS_MD5_NO_WINDOW&&(WINDOW=!1);var WEB_WORKER=!WINDOW&&"object"===("undefined"==typeof self?"undefined":_typeof(self)),NODE_JS=!root.JS_MD5_NO_NODE_JS&&"object"===(void 0===process?"undefined":_typeof(process))&&process.versions&&process.versions.node;NODE_JS?root=global:WEB_WORKER&&(root=self);var COMMON_JS=!root.JS_MD5_NO_COMMON_JS&&"object"===_typeof(module)&&module.exports,AMD=__webpack_require__(5),ARRAY_BUFFER=!root.JS_MD5_NO_ARRAY_BUFFER&&"undefined"!=typeof ArrayBuffer,HEX_CHARS="0123456789abcdef".split(""),EXTRA=[128,32768,8388608,-2147483648],SHIFT=[0,8,16,24],OUTPUT_TYPES=["hex","array","digest","buffer","arrayBuffer","base64"],BASE64_ENCODE_CHAR="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".split(""),blocks=[],buffer8;if(ARRAY_BUFFER){var buffer=new ArrayBuffer(68);buffer8=new Uint8Array(buffer),blocks=new Uint32Array(buffer)}!root.JS_MD5_NO_NODE_JS&&Array.isArray||(Array.isArray=function(t){return"[object Array]"===Object.prototype.toString.call(t)}),!ARRAY_BUFFER||!root.JS_MD5_NO_ARRAY_BUFFER_IS_VIEW&&ArrayBuffer.isView||(ArrayBuffer.isView=function(t){return"object"===(void 0===t?"undefined":_typeof(t))&&t.buffer&&t.buffer.constructor===ArrayBuffer});var createOutputMethod=function(t){return function(e){return new Md5(!0).update(e)[t]()}},createMethod=function(){var t=createOutputMethod("hex");NODE_JS&&(t=nodeWrap(t)),t.create=function(){return new Md5},t.update=function(e){return t.create().update(e)};for(var e=0;e<OUTPUT_TYPES.length;++e){var n=OUTPUT_TYPES[e];t[n]=createOutputMethod(n)}return t},nodeWrap=function nodeWrap(method){var crypto=eval("require('crypto')"),Buffer=eval("require('buffer').Buffer"),nodeMethod=function(t){if("string"==typeof t)return crypto.createHash("md5").update(t,"utf8").digest("hex");if(null===t||void 0===t)throw ERROR;return t.constructor===ArrayBuffer&&(t=new Uint8Array(t)),Array.isArray(t)||ArrayBuffer.isView(t)||t.constructor===Buffer?crypto.createHash("md5").update(new Buffer(t)).digest("hex"):method(t)};return nodeMethod};function Md5(t){if(t)blocks[0]=blocks[16]=blocks[1]=blocks[2]=blocks[3]=blocks[4]=blocks[5]=blocks[6]=blocks[7]=blocks[8]=blocks[9]=blocks[10]=blocks[11]=blocks[12]=blocks[13]=blocks[14]=blocks[15]=0,this.blocks=blocks,this.buffer8=buffer8;else if(ARRAY_BUFFER){var e=new ArrayBuffer(68);this.buffer8=new Uint8Array(e),this.blocks=new Uint32Array(e)}else this.blocks=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];this.h0=this.h1=this.h2=this.h3=this.start=this.bytes=this.hBytes=0,this.finalized=this.hashed=!1,this.first=!0}Md5.prototype.update=function(t){if(!this.finalized){var e,n=void 0===t?"undefined":_typeof(t);if("string"!==n){if("object"!==n)throw ERROR;if(null===t)throw ERROR;if(ARRAY_BUFFER&&t.constructor===ArrayBuffer)t=new Uint8Array(t);else if(!(Array.isArray(t)||ARRAY_BUFFER&&ArrayBuffer.isView(t)))throw ERROR;e=!0}for(var r,i,o=0,s=t.length,a=this.blocks,u=this.buffer8;o<s;){if(this.hashed&&(this.hashed=!1,a[0]=a[16],a[16]=a[1]=a[2]=a[3]=a[4]=a[5]=a[6]=a[7]=a[8]=a[9]=a[10]=a[11]=a[12]=a[13]=a[14]=a[15]=0),e)if(ARRAY_BUFFER)for(i=this.start;o<s&&i<64;++o)u[i++]=t[o];else for(i=this.start;o<s&&i<64;++o)a[i>>2]|=t[o]<<SHIFT[3&i++];else if(ARRAY_BUFFER)for(i=this.start;o<s&&i<64;++o)(r=t.charCodeAt(o))<128?u[i++]=r:r<2048?(u[i++]=192|r>>6,u[i++]=128|63&r):r<55296||r>=57344?(u[i++]=224|r>>12,u[i++]=128|r>>6&63,u[i++]=128|63&r):(r=65536+((1023&r)<<10|1023&t.charCodeAt(++o)),u[i++]=240|r>>18,u[i++]=128|r>>12&63,u[i++]=128|r>>6&63,u[i++]=128|63&r);else for(i=this.start;o<s&&i<64;++o)(r=t.charCodeAt(o))<128?a[i>>2]|=r<<SHIFT[3&i++]:r<2048?(a[i>>2]|=(192|r>>6)<<SHIFT[3&i++],a[i>>2]|=(128|63&r)<<SHIFT[3&i++]):r<55296||r>=57344?(a[i>>2]|=(224|r>>12)<<SHIFT[3&i++],a[i>>2]|=(128|r>>6&63)<<SHIFT[3&i++],a[i>>2]|=(128|63&r)<<SHIFT[3&i++]):(r=65536+((1023&r)<<10|1023&t.charCodeAt(++o)),a[i>>2]|=(240|r>>18)<<SHIFT[3&i++],a[i>>2]|=(128|r>>12&63)<<SHIFT[3&i++],a[i>>2]|=(128|r>>6&63)<<SHIFT[3&i++],a[i>>2]|=(128|63&r)<<SHIFT[3&i++]);this.lastByteIndex=i,this.bytes+=i-this.start,i>=64?(this.start=i-64,this.hash(),this.hashed=!0):this.start=i}return this.bytes>4294967295&&(this.hBytes+=this.bytes/4294967296<<0,this.bytes=this.bytes%4294967296),this}},Md5.prototype.finalize=function(){if(!this.finalized){this.finalized=!0;var t=this.blocks,e=this.lastByteIndex;t[e>>2]|=EXTRA[3&e],e>=56&&(this.hashed||this.hash(),t[0]=t[16],t[16]=t[1]=t[2]=t[3]=t[4]=t[5]=t[6]=t[7]=t[8]=t[9]=t[10]=t[11]=t[12]=t[13]=t[14]=t[15]=0),t[14]=this.bytes<<3,t[15]=this.hBytes<<3|this.bytes>>>29,this.hash()}},Md5.prototype.hash=function(){var t,e,n,r,i,o,s=this.blocks;this.first?e=((e=((t=((t=s[0]-680876937)<<7|t>>>25)-271733879<<0)^(n=((n=(-271733879^(r=((r=(-1732584194^2004318071&t)+s[1]-117830708)<<12|r>>>20)+t<<0)&(-271733879^t))+s[2]-1126478375)<<17|n>>>15)+r<<0)&(r^t))+s[3]-1316259209)<<22|e>>>10)+n<<0:(t=this.h0,e=this.h1,n=this.h2,e=((e+=((t=((t+=((r=this.h3)^e&(n^r))+s[0]-680876936)<<7|t>>>25)+e<<0)^(n=((n+=(e^(r=((r+=(n^t&(e^n))+s[1]-389564586)<<12|r>>>20)+t<<0)&(t^e))+s[2]+606105819)<<17|n>>>15)+r<<0)&(r^t))+s[3]-1044525330)<<22|e>>>10)+n<<0),e=((e+=((t=((t+=(r^e&(n^r))+s[4]-176418897)<<7|t>>>25)+e<<0)^(n=((n+=(e^(r=((r+=(n^t&(e^n))+s[5]+1200080426)<<12|r>>>20)+t<<0)&(t^e))+s[6]-1473231341)<<17|n>>>15)+r<<0)&(r^t))+s[7]-45705983)<<22|e>>>10)+n<<0,e=((e+=((t=((t+=(r^e&(n^r))+s[8]+1770035416)<<7|t>>>25)+e<<0)^(n=((n+=(e^(r=((r+=(n^t&(e^n))+s[9]-1958414417)<<12|r>>>20)+t<<0)&(t^e))+s[10]-42063)<<17|n>>>15)+r<<0)&(r^t))+s[11]-1990404162)<<22|e>>>10)+n<<0,e=((e+=((t=((t+=(r^e&(n^r))+s[12]+1804603682)<<7|t>>>25)+e<<0)^(n=((n+=(e^(r=((r+=(n^t&(e^n))+s[13]-40341101)<<12|r>>>20)+t<<0)&(t^e))+s[14]-1502002290)<<17|n>>>15)+r<<0)&(r^t))+s[15]+1236535329)<<22|e>>>10)+n<<0,e=((e+=((r=((r+=(e^n&((t=((t+=(n^r&(e^n))+s[1]-165796510)<<5|t>>>27)+e<<0)^e))+s[6]-1069501632)<<9|r>>>23)+t<<0)^t&((n=((n+=(t^e&(r^t))+s[11]+643717713)<<14|n>>>18)+r<<0)^r))+s[0]-373897302)<<20|e>>>12)+n<<0,e=((e+=((r=((r+=(e^n&((t=((t+=(n^r&(e^n))+s[5]-701558691)<<5|t>>>27)+e<<0)^e))+s[10]+38016083)<<9|r>>>23)+t<<0)^t&((n=((n+=(t^e&(r^t))+s[15]-660478335)<<14|n>>>18)+r<<0)^r))+s[4]-405537848)<<20|e>>>12)+n<<0,e=((e+=((r=((r+=(e^n&((t=((t+=(n^r&(e^n))+s[9]+568446438)<<5|t>>>27)+e<<0)^e))+s[14]-1019803690)<<9|r>>>23)+t<<0)^t&((n=((n+=(t^e&(r^t))+s[3]-187363961)<<14|n>>>18)+r<<0)^r))+s[8]+1163531501)<<20|e>>>12)+n<<0,e=((e+=((r=((r+=(e^n&((t=((t+=(n^r&(e^n))+s[13]-1444681467)<<5|t>>>27)+e<<0)^e))+s[2]-51403784)<<9|r>>>23)+t<<0)^t&((n=((n+=(t^e&(r^t))+s[7]+1735328473)<<14|n>>>18)+r<<0)^r))+s[12]-1926607734)<<20|e>>>12)+n<<0,e=((e+=((o=(r=((r+=((i=e^n)^(t=((t+=(i^r)+s[5]-378558)<<4|t>>>28)+e<<0))+s[8]-2022574463)<<11|r>>>21)+t<<0)^t)^(n=((n+=(o^e)+s[11]+1839030562)<<16|n>>>16)+r<<0))+s[14]-35309556)<<23|e>>>9)+n<<0,e=((e+=((o=(r=((r+=((i=e^n)^(t=((t+=(i^r)+s[1]-1530992060)<<4|t>>>28)+e<<0))+s[4]+1272893353)<<11|r>>>21)+t<<0)^t)^(n=((n+=(o^e)+s[7]-155497632)<<16|n>>>16)+r<<0))+s[10]-1094730640)<<23|e>>>9)+n<<0,e=((e+=((o=(r=((r+=((i=e^n)^(t=((t+=(i^r)+s[13]+681279174)<<4|t>>>28)+e<<0))+s[0]-358537222)<<11|r>>>21)+t<<0)^t)^(n=((n+=(o^e)+s[3]-722521979)<<16|n>>>16)+r<<0))+s[6]+76029189)<<23|e>>>9)+n<<0,e=((e+=((o=(r=((r+=((i=e^n)^(t=((t+=(i^r)+s[9]-640364487)<<4|t>>>28)+e<<0))+s[12]-421815835)<<11|r>>>21)+t<<0)^t)^(n=((n+=(o^e)+s[15]+530742520)<<16|n>>>16)+r<<0))+s[2]-995338651)<<23|e>>>9)+n<<0,e=((e+=((r=((r+=(e^((t=((t+=(n^(e|~r))+s[0]-198630844)<<6|t>>>26)+e<<0)|~n))+s[7]+1126891415)<<10|r>>>22)+t<<0)^((n=((n+=(t^(r|~e))+s[14]-1416354905)<<15|n>>>17)+r<<0)|~t))+s[5]-57434055)<<21|e>>>11)+n<<0,e=((e+=((r=((r+=(e^((t=((t+=(n^(e|~r))+s[12]+1700485571)<<6|t>>>26)+e<<0)|~n))+s[3]-1894986606)<<10|r>>>22)+t<<0)^((n=((n+=(t^(r|~e))+s[10]-1051523)<<15|n>>>17)+r<<0)|~t))+s[1]-2054922799)<<21|e>>>11)+n<<0,e=((e+=((r=((r+=(e^((t=((t+=(n^(e|~r))+s[8]+1873313359)<<6|t>>>26)+e<<0)|~n))+s[15]-30611744)<<10|r>>>22)+t<<0)^((n=((n+=(t^(r|~e))+s[6]-1560198380)<<15|n>>>17)+r<<0)|~t))+s[13]+1309151649)<<21|e>>>11)+n<<0,e=((e+=((r=((r+=(e^((t=((t+=(n^(e|~r))+s[4]-145523070)<<6|t>>>26)+e<<0)|~n))+s[11]-1120210379)<<10|r>>>22)+t<<0)^((n=((n+=(t^(r|~e))+s[2]+718787259)<<15|n>>>17)+r<<0)|~t))+s[9]-343485551)<<21|e>>>11)+n<<0,this.first?(this.h0=t+1732584193<<0,this.h1=e-271733879<<0,this.h2=n-1732584194<<0,this.h3=r+271733878<<0,this.first=!1):(this.h0=this.h0+t<<0,this.h1=this.h1+e<<0,this.h2=this.h2+n<<0,this.h3=this.h3+r<<0)},Md5.prototype.hex=function(){this.finalize();var t=this.h0,e=this.h1,n=this.h2,r=this.h3;return HEX_CHARS[t>>4&15]+HEX_CHARS[15&t]+HEX_CHARS[t>>12&15]+HEX_CHARS[t>>8&15]+HEX_CHARS[t>>20&15]+HEX_CHARS[t>>16&15]+HEX_CHARS[t>>28&15]+HEX_CHARS[t>>24&15]+HEX_CHARS[e>>4&15]+HEX_CHARS[15&e]+HEX_CHARS[e>>12&15]+HEX_CHARS[e>>8&15]+HEX_CHARS[e>>20&15]+HEX_CHARS[e>>16&15]+HEX_CHARS[e>>28&15]+HEX_CHARS[e>>24&15]+HEX_CHARS[n>>4&15]+HEX_CHARS[15&n]+HEX_CHARS[n>>12&15]+HEX_CHARS[n>>8&15]+HEX_CHARS[n>>20&15]+HEX_CHARS[n>>16&15]+HEX_CHARS[n>>28&15]+HEX_CHARS[n>>24&15]+HEX_CHARS[r>>4&15]+HEX_CHARS[15&r]+HEX_CHARS[r>>12&15]+HEX_CHARS[r>>8&15]+HEX_CHARS[r>>20&15]+HEX_CHARS[r>>16&15]+HEX_CHARS[r>>28&15]+HEX_CHARS[r>>24&15]},Md5.prototype.toString=Md5.prototype.hex,Md5.prototype.digest=function(){this.finalize();var t=this.h0,e=this.h1,n=this.h2,r=this.h3;return[255&t,t>>8&255,t>>16&255,t>>24&255,255&e,e>>8&255,e>>16&255,e>>24&255,255&n,n>>8&255,n>>16&255,n>>24&255,255&r,r>>8&255,r>>16&255,r>>24&255]},Md5.prototype.array=Md5.prototype.digest,Md5.prototype.arrayBuffer=function(){this.finalize();var t=new ArrayBuffer(16),e=new Uint32Array(t);return e[0]=this.h0,e[1]=this.h1,e[2]=this.h2,e[3]=this.h3,t},Md5.prototype.buffer=Md5.prototype.arrayBuffer,Md5.prototype.base64=function(){for(var t,e,n,r="",i=this.array(),o=0;o<15;)t=i[o++],e=i[o++],n=i[o++],r+=BASE64_ENCODE_CHAR[t>>>2]+BASE64_ENCODE_CHAR[63&(t<<4|e>>>4)]+BASE64_ENCODE_CHAR[63&(e<<2|n>>>6)]+BASE64_ENCODE_CHAR[63&n];return t=i[o],r+=BASE64_ENCODE_CHAR[t>>>2]+BASE64_ENCODE_CHAR[t<<4&63]+"=="};var exports=createMethod();COMMON_JS?module.exports=exports:(root.md5=exports,AMD&&(__WEBPACK_AMD_DEFINE_RESULT__=function(){return exports}.call(exports,__webpack_require__,exports,module),void 0===__WEBPACK_AMD_DEFINE_RESULT__||(module.exports=__WEBPACK_AMD_DEFINE_RESULT__)))}()}).call(this,__webpack_require__(7),__webpack_require__(4),__webpack_require__(6)(module))},function(t,e,n){"use strict";var r=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}();var i=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._endpoint=e,this._targetEndpoint=null}return r(t,[{key:"buildProxyData",value:function(t){return msgpack.encode({endpoint:this._targetEndpoint,data:t})}},{key:"endpoint",get:function(){return this._endpoint}},{key:"targetEndpoint",get:function(){return this._targetEndpoint},set:function(t){this._targetEndpoint=t}}]),t}();t.exports=i},function(t,e,n){"use strict";var r=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}();var i=n(0),o=n(3),s=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),i.assign(this),this._map={},this._msgOptions=e,function(){var t=this;setInterval(function(){for(var e in t._map)t._map[e]>Date.now()||u.call(t,e)},o.MID_TTL+1e3)}.call(this)}return r(t,[{key:"service",value:function(t,e){var n=!0;o.SERVER_PUSH.kickOut==t.method&&(n=!1),o.SERVER_PUSH.kickOutRoom==t.method&&(n=!1),n&&(0==t.flag&&e(JSON.stringify({}),!1),1==t.flag&&e(msgpack.encode({},this._msgOptions),!1));var r=null;0==t.flag&&(r=JSON.parse(t.payload)),1==t.flag&&(r=msgpack.decode(t.payload,this._msgOptions)),r&&this[t.method].call(this,r)}},{key:"kickout",value:function(t){this.emit(o.SERVER_PUSH.kickOut,t)}},{key:"kickoutroom",value:function(t){t.rid&&(t.rid=new Int64BE(t.rid)),this.emit(o.SERVER_PUSH.kickOutRoom,t)}},{key:"pushmsg",value:function(t){t.from&&(t.from=new Int64BE(t.from)),t.mid&&(t.mid=new Int64BE(t.mid),!a.call(this,1,t.mid,t.from))||(t.ftype>0?this.emit(o.SERVER_PUSH.recvFile,t):(delete t.ftype,this.emit(o.SERVER_PUSH.recvMessage,t)))}},{key:"pushgroupmsg",value:function(t){t.from&&(t.from=new Int64BE(t.from)),t.mid&&(t.mid=new Int64BE(t.mid),!a.call(this,2,t.mid,t.from,t.gid))||(t.gid&&(t.gid=new Int64BE(t.gid)),t.ftype>0?this.emit(o.SERVER_PUSH.recvGroupFile,t):(delete t.ftype,this.emit(o.SERVER_PUSH.recvGroupMessage,t)))}},{key:"pushroommsg",value:function(t){t.from&&(t.from=new Int64BE(t.from)),t.mid&&(t.mid=new Int64BE(t.mid),!a.call(this,3,t.mid,t.from,t.rid))||(t.rid&&(t.rid=new Int64BE(t.rid)),t.ftype>0?this.emit(o.SERVER_PUSH.recvRoomFile,t):(delete t.ftype,this.emit(o.SERVER_PUSH.recvRoomMessage,t)))}},{key:"pushbroadcastmsg",value:function(t){t.from&&(t.from=new Int64BE(t.from)),t.mid&&(t.mid=new Int64BE(t.mid),!a.call(this,4,t.mid,t.from))||(t.ftype>0?this.emit(o.SERVER_PUSH.recvBroadcastFile,t):(delete t.ftype,this.emit(o.SERVER_PUSH.recvBroadcastMessage,t)))}},{key:"transmsg",value:function(t){t.from&&(t.from=new Int64BE(t.from)),t.mid&&(t.mid=new Int64BE(t.mid),!a.call(this,1,t.mid,t.from))||(t.omid&&(t.omid=new Int64BE(t.omid)),this.emit(o.SERVER_PUSH.recvTranslatedMessage,t))}},{key:"transgroupmsg",value:function(t){t.from&&(t.from=new Int64BE(t.from)),t.mid&&(t.mid=new Int64BE(t.mid),!a.call(this,2,t.mid,t.from,t.gid))||(t.gid&&(t.gid=new Int64BE(t.gid)),t.omid&&(t.omid=new Int64BE(t.omid)),this.emit(o.SERVER_PUSH.recvTranslatedGroupMessage,t))}},{key:"transroommsg",value:function(t){t.from&&(t.from=new Int64BE(t.from)),t.mid&&(t.mid=new Int64BE(t.mid),!a.call(this,3,t.mid,t.from,t.rid))||(t.rid&&(t.rid=new Int64BE(t.rid)),t.omid&&(t.omid=new Int64BE(t.omid)),this.emit(o.SERVER_PUSH.recvTranslatedRoomMessage,t))}},{key:"transbroadcastmsg",value:function(t){t.from&&(t.from=new Int64BE(t.from)),t.mid&&(t.mid=new Int64BE(t.mid),!a.call(this,4,t.mid,t.fromt))||(t.omid&&(t.omid=new Int64BE(t.omid)),this.emit(o.SERVER_PUSH.recvTranslatedBroadcastMessage,t))}},{key:"pushunread",value:function(t){if(t.p2p){var e=[];t.p2p.forEach(function(t,n){e[n]=new Int64BE(t)}),t.p2p=e}if(t.group){var n=[];t.group.forEach(function(t,e){n[e]=new Int64BE(t)}),t.group=n}this.emit(o.SERVER_PUSH.recvUnreadMsgStatus,t)}},{key:"ping",value:function(t){this.emit(o.SERVER_PUSH.recvPing,t)}}]),t}();function a(t,e,n,r){var i=[];i.push(t),i.push(e),i.push(n),void 0!=r&&i.push(r);var s=i.join("_");if(this._map.hasOwnProperty(s)){if(this._map[s]>Date.now())return!1;delete this._map[s]}return this._map[s]=o.MID_TTL+Date.now(),!0}function u(t){var e=this;setTimeout(function(){delete e._map[t]},0)}t.exports=s},function(t,e,n){"use strict";var r=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}();var i=n(0),o=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),i.assign(this)}return r(t,[{key:"service",value:function(t,e){this.emit(t.method,t.payload,e)}}]),t}();t.exports=o},function(t,e,n){"use strict";var r=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}();var i=n(1),o=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._cbMap={},this._exMap={},function(){var t=this;setInterval(function(){for(var e in t._exMap)t._exMap[e]>Date.now()||s.call(t,e,new Error("timeout with expire"))},i.CHECK_CBS_INTERVAL)}.call(this)}return r(t,[{key:"addCb",value:function(t,e,n){this._cbMap.hasOwnProperty(t)||(this._cbMap[t]=e),n||(n=i.SEND_TIMEOUT),this._exMap[t]=n+Date.now()}},{key:"removeCb",value:function(t){if(t)(function(t){var e=this;setTimeout(function(){a.call(e,t)},0)}).call(this,t);else for(var e in this._cbMap)s.call(this,e,new Error("timeout with closed!"))}},{key:"execCb",value:function(t,e){s.call(this,t,e)}}]),t}();function s(t,e){var n=this;setTimeout(function(){(function(t,e){this._cbMap.hasOwnProperty(t)&&(this._cbMap[t](e),a.call(this,t))}).call(n,t,e)},0)}function a(t){this._cbMap.hasOwnProperty(t)&&delete this._cbMap[t],this._exMap.hasOwnProperty(t)&&delete this._exMap[t]}t.exports=o},function(t,e,n){"use strict";var r=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}();var i=n(2).Buffer,o=n(1),s=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}return r(t,[{key:"buildPkgData",value:function(t){var e={};return e.magic=t.magic||o.TCP_MAGIC,e.version=t.version||0,e.flag=t.flag||0,e.mtype=t.mtype||0,e.ss=t.ss||0,e.method=t.method||null,e.seq=t.seq||0,e.payload=t.payload||null,e.payload&&(e.psize=i.byteLength(e.payload)),e.method&&(e.ss=i.byteLength(e.method)),e.wpos=0,e}},{key:"cbKey",value:function(t){return t.magic+"_"+t.seq}},{key:"isHTTP",value:function(t){return o.HTTP_MAGIC.equals(t.magic)}},{key:"isTCP",value:function(t){return o.TCP_MAGIC.equals(t.magic)}},{key:"isMsgPack",value:function(t){return 1==t.flag}},{key:"isJson",value:function(t){return 0==t.flag}},{key:"isOneWay",value:function(t){return 0==t.mtype}},{key:"isTwoWay",value:function(t){return 1==t.mtype}},{key:"isQuest",value:function(t){return this.isTwoWay(t)||this.isOneWay(t)}},{key:"isAnswer",value:function(t){return 2==t.mtype}},{key:"isSupportPack",value:function(t){return this.isMsgPack(t)!=this.isJson(t)}},{key:"enCode",value:function(t){return this.isOneWay(t)?this.enCodeOneway(t):this.isTwoWay(t)?this.enCodeTwoway(t):this.isAnswer(t)?this.enCodeAnswer(t):null}},{key:"enCodeOneway",value:function(t){var e=a.call(this,t,12+t.ss+t.psize);t.wpos=e.writeUInt8(t.ss,t.wpos),t.wpos=e.writeUInt32LE(t.psize,t.wpos);var n=i.from(t.method);if(t.wpos+=n.copy(e,t.wpos,0),this.isJson(t)){var r=i.from(t.payload);t.wpos+=r.copy(e,t.wpos,0)}return this.isMsgPack(t)&&(this.wpos+=this.payload.copy(e,this.wpos,0)),e}},{key:"enCodeTwoway",value:function(t){var e=a.call(this,t,16+t.ss+t.psize);t.wpos=e.writeUInt8(t.ss,t.wpos),t.wpos=e.writeUInt32LE(t.psize,t.wpos),t.wpos=e.writeUInt32LE(t.seq,t.wpos);var n=i.from(t.method);if(t.wpos+=n.copy(e,t.wpos,0),this.isJson(t)){var r=i.from(t.payload);t.wpos+=r.copy(e,t.wpos,0)}return this.isMsgPack(t)&&(t.wpos+=t.payload.copy(e,t.wpos,0)),e}},{key:"enCodeAnswer",value:function(t){var e=a.call(this,t,16+t.psize);if(t.wpos=e.writeUInt8(t.ss,t.wpos),t.wpos=e.writeUInt32LE(t.psize,t.wpos),t.wpos=e.writeUInt32LE(t.seq,t.wpos),this.isJson(t)){var n=i.from(t.payload);t.wpos+=n.copy(e,t.wpos,0)}return this.isMsgPack(t)&&(t.wpos+=t.payload.copy(e,t.wpos,0)),e}},{key:"peekHead",value:function(t){var e={},n=0,r=i.allocUnsafe(4);return n+=t.copy(r,0,n,n+4),e.magic=r,r=i.allocUnsafe(1),n+=t.copy(r,0,n,n+1),e.version=o.FPNN_VERSION.indexOf(r),n+=t.copy(r,0,n,n+1),e.flag=o.FP_FLAG.indexOf(r),n+=t.copy(r,0,n,n+1),e.mtype=o.FP_MESSAGE_TYPE.indexOf(r),n+=t.copy(r,0,n,n+1),e.ss=r.readUInt8(0),e.psize=t.readUInt32LE(n),e.wpos=n+4,e}},{key:"deCode",value:function(t){var e=this.peekHead(t);return this.isOneWay(e)&&this.deCodeOneWay(t,e),this.isTwoWay(e)&&this.deCodeTwoWay(t,e),this.isAnswer(e)&&this.deCodeAnswer(t,e),e}},{key:"deCodeOneWay",value:function(t,e){if(t.length==12+e.ss+e.psize){var n=i.allocUnsafe(e.ss);e.wpos+=t.copy(n,0,e.wpos,e.wpos+e.ss),e.method=n.toString();var r=i.allocUnsafe(e.psize);e.wpos+=t.copy(r,0,e.wpos),this.isJson(e)&&(e.payload=r.toString()),this.isMsgPack(e)&&(e.payload=r)}else e=null}},{key:"deCodeTwoWay",value:function(t,e){if(t.length==16+e.ss+e.psize){e.seq=t.readUInt32LE(e.wpos),e.wpos+=4;var n=i.allocUnsafe(e.ss);e.wpos+=t.copy(n,0,e.wpos,e.wpos+e.ss),e.method=n.toString();var r=i.allocUnsafe(e.psize);e.wpos+=t.copy(r,0,e.wpos),this.isJson(e)&&(e.payload=r.toString()),this.isMsgPack(e)&&(e.payload=r)}else e=null}},{key:"deCodeAnswer",value:function(t,e){if(t.length==16+e.psize){e.seq=t.readUInt32LE(e.wpos),e.wpos+=4;var n=i.allocUnsafe(e.psize);e.wpos+=t.copy(n,0,e.wpos),this.isJson(e)&&(e.payload=n.toString()),this.isMsgPack(e)&&(e.payload=n)}else e=null}}]),t}();function a(t,e){var n=i.allocUnsafe(e);return this.isHTTP(t)&&(t.wpos+=o.HTTP_MAGIC.copy(n,t.wpos,0)),this.isTCP(t)&&(t.wpos+=o.TCP_MAGIC.copy(n,t.wpos,0)),t.wpos+=o.FPNN_VERSION.copy(n,t.wpos,t.version,t.version+1),this.isJson(t)&&(t.wpos+=o.FP_FLAG.copy(n,t.wpos,t.flag,t.flag+1)),this.isMsgPack(t)&&(t.wpos+=o.FP_FLAG.copy(n,t.wpos,t.flag,t.flag+1)),t.wpos+=o.FP_MESSAGE_TYPE.copy(n,t.wpos,t.mtype,t.mtype+1),n}t.exports=s},function(t,e,n){"use strict";var r=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}();n(1);var i=n(0),o=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),i.assign(this),this._endpoint=e.endpoint||null,this._connectionTimeout=e.connectionTimeout||1e4,this._client=null,this._writeID=0,this._timeoutID=0,this._queue=[]}return r(t,[{key:"write",value:function(t){if(t){var e=t.buffer.slice(t.byteOffset,t.byteOffset+t.byteLength);this._queue.push(e)}if(!this._writeID){var n=this;this._writeID=setInterval(function(){(function(){if(!this.isOpen)return;for(;this._queue.length;){try{this._client.send(this._queue[0])}catch(t){return void s.call(this,t)}this._queue.shift()}}).call(n)},0)}}},{key:"close",value:function(t){t&&this.emit("error",t),this._client&&this._client.close()}},{key:"open",value:function(){if(this.isConnecting||this.isOpen||!this._endpoint)this.emit("error",new Error("has connected or worng endpoint!"));else{var t=this;try{this._client=new WebSocket(this._endpoint)}catch(e){return void s.call(t,e)}this._client.binaryType="arraybuffer",this._timeoutID&&(clearTimeout(this._timeoutID),this._timeoutID=0),this._timeoutID=setTimeout(function(){t.isConnecting&&t.close(new Error("connect timeout!"))},this._connectionTimeout),this._client.onopen=function(e){(function(){this._timeoutID&&(clearTimeout(this._timeoutID),this._timeoutID=0);this.emit("connect")}).call(t)},this._client.onmessage=function(e){(function(t){this.emit("data",t)}).call(t,e.data)},this._client.onclose=function(e){(function(){this._writeID&&(clearInterval(this._writeID),this._writeID=0);this._timeoutID&&(clearTimeout(this._timeoutID),this._timeoutID=0);this.emit("close")}).call(t)},this._client.onerror=function(e){s.call(t,e)}}}},{key:"endpoint",get:function(){return this._endpoint}},{key:"isOpen",get:function(){return!!this._client&&this._client.readyState==WebSocket.OPEN}},{key:"isConnecting",get:function(){return!!this._client&&this._client.readyState==WebSocket.CONNECTING}}]),t}();function s(t){this.emit("error",t)}t.exports=o},function(t,e,n){"use strict";var r=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}();var i=n(2).Buffer,o=n(1),s=n(0),a=n(14),u=n(13),c=n(12),f=n(11),l=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),s.assign(this),this._autoReconnect=e.autoReconnect||!1,this._proxy=e.proxy||null,this._proxy&&(this._proxy.targetEndpoint=e.endpoint,e.endpoint=this._proxy.endpoint),this._conn=new a(e);var n=this;this._conn.on("connect",function(){(function(){this._reconnectID&&(clearTimeout(this._reconnectID),this._reconnectID=0);this.emit("connect")}).call(n)}),this._conn.on("close",function(){(function(){this._readID&&(clearInterval(this._readID),this._readID=0);this._reconnectID&&(clearTimeout(this._reconnectID),this._reconnectID=0);this._seq=0,this._wpos=0,this._peekData=null,this._buffer=i.allocUnsafe(o.READ_BUFFER_LEN),this.emit("close"),this._autoReconnect&&function(){if(this._reconnectID)return;var t=this;this._reconnectID=setTimeout(function(){t.connect()},100)}.call(this)}).call(n)}),this._conn.on("data",function(t){(function(t){t=i.from(t);var e=this._wpos+t.length;e>this._buffer.length&&p.call(this,e,2*o.READ_BUFFER_LEN);if(this._wpos+=t.copy(this._buffer,this._wpos,0),!this._readID){var n=this;this._readID=setInterval(function(){(function(){if(this._wpos<12)return;if(!this._peekData&&(this._peekData=function(t){var e=null;if(t.length>=12){if(e=this._pkg.peekHead(t),!function(t){if(!o.TCP_MAGIC.equals(t.magic)&&!o.HTTP_MAGIC.equals(t.magic))return!1;if(t.version<0||t.version>=o.FPNN_VERSION.length)return!1;if(t.flag<0||t.flag>=o.FP_FLAG.length)return!1;if(t.mtype<0||t.mtype>=o.FP_MESSAGE_TYPE.length)return!1;return!0}.call(this,e))return null;this._pkg.isOneWay(e)&&(e.pkgLen=12+e.ss+e.psize),this._pkg.isTwoWay(e)&&(e.pkgLen=16+e.ss+e.psize),this._pkg.isAnswer(e)&&(e.pkgLen=16+e.psize),e.pkgLen>0&&(e.buffer=i.allocUnsafe(e.pkgLen))}return e}.call(this,this._buffer),!this._peekData))return void this.conn.close(new Error("worng package!"));var t=this._wpos-this._peekData.pkgLen;if(t<0)return;this._buffer.copy(this._peekData.buffer,0,0,this._peekData.pkgLen);var e=this._pkg.deCode(this._peekData.buffer);if(p.call(this,2*t,o.READ_BUFFER_LEN,this._peekData.pkgLen),delete this._peekData,this._peekData=null,this._pkg.isAnswer(e)){var n=this._pkg.cbKey(e);this._cbs.execCb(n,e)}if(this._pkg.isQuest(e)){var r=this;this._psr.service(e,function(t,n){(function(t,e,n,r){var i={flag:t,mtype:2,seq:e,ss:(r=r||!1)?1:0,payload:n};this.sendQuest(i)}).call(r,e.flag,e.seq,t,n)})}}).call(n)},0)}}).call(n,t)}),this._conn.on("error",function(t){h.call(n,t)}),this._pkg=new u,this._cbs=new c,this._psr=new f,this._seq=0,this._wpos=0,this._peekData=null,this._readID=0,this._reconnectID=0,this._buffer=i.allocUnsafe(o.READ_BUFFER_LEN)}return r(t,[{key:"connect",value:function(){this.hasConnect?this._conn.close(new Error("has connected!")):this._conn.open()}},{key:"sendQuest",value:function(t,e,n){var r={};r.magic=t.magic||o.TCP_MAGIC,r.version=t.version||1,r.flag=t.flag||0,r.mtype=void 0!==t.mtype?t.mtype:1,r.method=t.method,r.seq=void 0===t.seq?++this._seq:t.seq,r.payload=t.payload,r=this._pkg.buildPkgData(r),e&&this._cbs.addCb(this._pkg.cbKey(r),e,n);var i=this._pkg.enCode(r);this._proxy&&(i=this._proxy.buildProxyData(i)),this._conn.write(i)}},{key:"sendNotify",value:function(t){var e={};e.magic=t.magic||o.TCP_MAGIC,e.version=t.version||1,e.flag=t.flag||0,e.mtype=t.mtype||0,e.method=t.method,e.payload=t.payload,e=this._pkg.buildPkgData(e);var n=this._pkg.enCode(e);this._proxy&&(n=this._proxy.buildProxyData(n)),this._conn.write(n)}},{key:"close",value:function(t){t&&h.call(this,t),this._conn.close()}},{key:"processor",get:function(){return this._psr},set:function(t){return this._psr=t}},{key:"isOpen",get:function(){return this._conn.isOpen}},{key:"hasConnect",get:function(){return this._conn.isOpen||this._conn.isConnecting}}]),t}();function h(t){this.emit("error",t)}function p(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=Math.max(t,e),o=i.allocUnsafe(r);this._wpos=this._buffer.copy(o,0,n,this._wpos),this._buffer=o}t.exports=l},function(t,e){var n={}.toString;t.exports=Array.isArray||function(t){return"[object Array]"==n.call(t)}},function(t,e){e.read=function(t,e,n,r,i){var o,s,a=8*i-r-1,u=(1<<a)-1,c=u>>1,f=-7,l=n?i-1:0,h=n?-1:1,p=t[e+l];for(l+=h,o=p&(1<<-f)-1,p>>=-f,f+=a;f>0;o=256*o+t[e+l],l+=h,f-=8);for(s=o&(1<<-f)-1,o>>=-f,f+=r;f>0;s=256*s+t[e+l],l+=h,f-=8);if(0===o)o=1-c;else{if(o===u)return s?NaN:1/0*(p?-1:1);s+=Math.pow(2,r),o-=c}return(p?-1:1)*s*Math.pow(2,o-r)},e.write=function(t,e,n,r,i,o){var s,a,u,c=8*o-i-1,f=(1<<c)-1,l=f>>1,h=23===i?Math.pow(2,-24)-Math.pow(2,-77):0,p=r?0:o-1,_=r?1:-1,d=e<0||0===e&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(a=isNaN(e)?1:0,s=f):(s=Math.floor(Math.log(e)/Math.LN2),e*(u=Math.pow(2,-s))<1&&(s--,u*=2),(e+=s+l>=1?h/u:h*Math.pow(2,1-l))*u>=2&&(s++,u/=2),s+l>=f?(a=0,s=f):s+l>=1?(a=(e*u-1)*Math.pow(2,i),s+=l):(a=e*Math.pow(2,l-1)*Math.pow(2,i),s=0));i>=8;t[n+p]=255&a,p+=_,a/=256,i-=8);for(s=s<<i|a,c+=i;c>0;t[n+p]=255&s,p+=_,s/=256,c-=8);t[n+p-_]|=128*d}},function(t,e,n){"use strict";e.byteLength=function(t){return 3*t.length/4-c(t)},e.toByteArray=function(t){var e,n,r,s,a,u=t.length;s=c(t),a=new o(3*u/4-s),n=s>0?u-4:u;var f=0;for(e=0;e<n;e+=4)r=i[t.charCodeAt(e)]<<18|i[t.charCodeAt(e+1)]<<12|i[t.charCodeAt(e+2)]<<6|i[t.charCodeAt(e+3)],a[f++]=r>>16&255,a[f++]=r>>8&255,a[f++]=255&r;2===s?(r=i[t.charCodeAt(e)]<<2|i[t.charCodeAt(e+1)]>>4,a[f++]=255&r):1===s&&(r=i[t.charCodeAt(e)]<<10|i[t.charCodeAt(e+1)]<<4|i[t.charCodeAt(e+2)]>>2,a[f++]=r>>8&255,a[f++]=255&r);return a},e.fromByteArray=function(t){for(var e,n=t.length,i=n%3,o="",s=[],a=0,u=n-i;a<u;a+=16383)s.push(f(t,a,a+16383>u?u:a+16383));1===i?(e=t[n-1],o+=r[e>>2],o+=r[e<<4&63],o+="=="):2===i&&(e=(t[n-2]<<8)+t[n-1],o+=r[e>>10],o+=r[e>>4&63],o+=r[e<<2&63],o+="=");return s.push(o),s.join("")};for(var r=[],i=[],o="undefined"!=typeof Uint8Array?Uint8Array:Array,s="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",a=0,u=s.length;a<u;++a)r[a]=s[a],i[s.charCodeAt(a)]=a;function c(t){var e=t.length;if(e%4>0)throw new Error("Invalid string. Length must be a multiple of 4");return"="===t[e-2]?2:"="===t[e-1]?1:0}function f(t,e,n){for(var i,o,s=[],a=e;a<n;a+=3)i=(t[a]<<16&16711680)+(t[a+1]<<8&65280)+(255&t[a+2]),s.push(r[(o=i)>>18&63]+r[o>>12&63]+r[o>>6&63]+r[63&o]);return s.join("")}i["-".charCodeAt(0)]=62,i["_".charCodeAt(0)]=63},function(t,e,n){"use strict";(function(e){var r=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}();n(1);var i=n(0),o=n(15),s=n(3),a=n(10),u=n(9),c=n(8),f=function(){function t(e){if(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),i.assign(this),this._dispatch=e.dispatch,this._pid=e.pid,this._uid=e.uid,this._token=e.token,this._version=e.version,this._recvUnreadMsgStatus=void 0===e.recvUnreadMsgStatus||e.recvUnreadMsgStatus,this._ssl=void 0===e.ssl||e.ssl,this._autoReconnect=void 0===e.autoReconnect||e.autoReconnect,this._connectionTimeout=e.connectionTimeout||3e4,this._ssl&&(this._proxyEndpoint=e.proxyEndpoint),this._midSeq=0,this._saltSeq=0,this._endpoint=null,this._ipv6=!1,this._rtmClient=null,this._dispatchClient=null,this._loginOptions=null,this._reconnectID=0,this._isClose=!1,this._msgOptions={codec:msgpack.createCodec({int64:!0})},this._processor=new a(this._msgOptions),this._proxyEndpoint){var n=g.call(this,this._proxyEndpoint);this._proxy=new u(n)}}return r(t,[{key:"login",value:function(t,e){if(this._endpoint=t||null,this._ipv6=e||!1,this._isClose=!1,this._endpoint)(function(t){if(null!=this._rtmClient&&this._rtmClient.isOpen)return void this._rtmClient.close();this._rtmClient=new o({endpoint:g.call(this,this._endpoint),autoReconnect:!1,connectionTimeout:this._connectionTimeout,proxy:this._proxy});var e=this;this._rtmClient.connect(),this._rtmClient.on("connect",function(){e._processor.on(s.SERVER_PUSH.kickOut,function(t){e._isClose=!0}),function(t){var e={pid:this._pid,uid:this._uid,token:this._token,version:this._version,unread:this._recvUnreadMsgStatus},n={flag:1,method:"auth",payload:msgpack.encode(e,this._msgOptions)},r=this;d.call(this,this._rtmClient,n,function(t,e){if(e&&e.ok)return r._reconnectID&&(clearTimeout(r._reconnectID),r._reconnectID=0),void r.emit("login",{endpoint:r._endpoint});if(e&&!e.ok){if(e.gate)return r._endpoint=e.gate,void r._rtmClient.close();r.emit("error",new Error("token error!")),r.emit("login",{error:e})}t&&r._rtmClient.close(t)},t)}.call(e,t)}),this._rtmClient.on("close",function(){e._rtmClient.removeEvent(),function(){this._reconnectID&&(clearTimeout(this._reconnectID),this._reconnectID=0);this.emit("close")}.call(e),m.call(e)}),this._rtmClient.on("error",function(t){e.emit("error",t)}),this._rtmClient.processor=this._processor}).call(this);else{var n=this;(function(t,e,n){var r=this;null==this._dispatchClient&&(this._dispatchClient=new o({endpoint:g.call(this,this._dispatch),autoReconnect:!1,connectionTimeout:this._connectionTimeout,proxy:this._proxy}),this._dispatchClient.on("connect",function(){var i={pid:r._pid,uid:r._uid,what:t,addrType:r._ipv6?"ipv6":"ipv4",version:r._version},o={flag:1,method:"which",payload:msgpack.encode(i,r._msgOptions)};d.call(r,r._dispatchClient,o,function(t,n){n&&(r._dispatchClient.close(),e(null,n)),t&&(r._dispatchClient.close(t),e(t,null))},n)}));this._dispatchClient.hasConnect||this._dispatchClient.connect()}).call(this,"rtmGated",function(t,e){e&&n.login(e.endpoint,n._ipv6),t&&m.call(n)},this._connectionTimeout)}}},{key:"sendMessage",value:function(t,e,n,r,i,o){r=r||"";var s={to:t,mid:h.call(this),mtype:e,msg:n,attrs:r},a={flag:1,method:"sendmsg",payload:msgpack.encode(s,this._msgOptions)};d.call(this,this._rtmClient,a,o,i)}},{key:"sendMessages",value:function(t,e,n,r,i,o){r=r||"";var s={tos:t,mid:h.call(this),mtype:e,msg:n,attrs:r},a={flag:1,method:"sendmsgs",payload:msgpack.encode(s,this._msgOptions)};d.call(this,this._rtmClient,a,o,i)}},{key:"sendGroupMessage",value:function(t,e,n,r,i,o){r=r||"";var s={gid:t,mid:h.call(this),mtype:e,msg:n,attrs:r},a={flag:1,method:"sendgroupmsg",payload:msgpack.encode(s,this._msgOptions)};d.call(this,this._rtmClient,a,o,i)}},{key:"sendRoomMessage",value:function(t,e,n,r,i,o){r=r||"";var s={rid:t,mid:h.call(this),mtype:e,msg:n,attrs:r},a={flag:1,method:"sendroommsg",payload:msgpack.encode(s,this._msgOptions)};d.call(this,this._rtmClient,a,o,i)}},{key:"close",value:function(){var t={flag:1,method:"bye",payload:msgpack.encode({},this._msgOptions)},e=this;d.call(this,this._rtmClient,t,function(t,n){e._isClose=!0,e._rtmClient.close()})}},{key:"addVariables",value:function(t,e,n){var r={var:t},i={flag:1,method:"addvariables",payload:msgpack.encode(r,this._msgOptions)};d.call(this,this._rtmClient,i,n,e)}},{key:"addFriends",value:function(t,e,n){var r={friends:t},i={flag:1,method:"addfriends",payload:msgpack.encode(r,this._msgOptions)};d.call(this,this._rtmClient,i,n,e)}},{key:"deleteFriends",value:function(t,e,n){var r={friends:t},i={flag:1,method:"delfriends",payload:msgpack.encode(r,this._msgOptions)};d.call(this,this._rtmClient,i,n,e)}},{key:"getFriends",value:function(t,e){var n={flag:1,method:"getfriends",payload:msgpack.encode({},this._msgOptions)};d.call(this,this._rtmClient,n,function(t,n){if(t)e(t,null);else{var r=n.uids;if(r){var i=[];return r.forEach(function(t,e){i[e]=new Int64BE(t)}),void e(null,i)}e(null,n)}},t)}},{key:"addGroupMembers",value:function(t,e,n,r){var i={gid:t,uids:e},o={flag:1,method:"addgroupmembers",payload:msgpack.encode(i,this._msgOptions)};d.call(this,this._rtmClient,o,r,n)}},{key:"deleteGroupMembers",value:function(t,e,n,r){var i={gid:t,uids:e},o={flag:1,method:"delgroupmembers",payload:msgpack.encode(i,this._msgOptions)};d.call(this,this._rtmClient,o,r,n)}},{key:"getGroupMembers",value:function(t,e,n){var r={gid:t},i={flag:1,method:"getgroupmembers",payload:msgpack.encode(r,this._msgOptions)};d.call(this,this._rtmClient,i,function(t,e){if(t)n(t,null);else{var r=e.uids;if(r){var i=[];return r.forEach(function(t,e){i[e]=new Int64BE(t)}),void n(null,i)}n(null,e)}},e)}},{key:"getUserGroups",value:function(t,e){var n={flag:1,method:"getusergroups",payload:msgpack.encode({},this._msgOptions)};d.call(this,this._rtmClient,n,function(t,n){if(t)e(t,null);else{var r=n.gids;if(r){var i=[];return r.forEach(function(t,e){i[e]=new Int64BE(t)}),void e(null,i)}e(null,n)}},t)}},{key:"enterRoom",value:function(t,e,n){var r={rid:t},i={flag:1,method:"enterroom",payload:msgpack.encode(r,this._msgOptions)};d.call(this,this._rtmClient,i,n,e)}},{key:"leaveRoom",value:function(t,e,n){var r={rid:t},i={flag:1,method:"leaveroom",payload:msgpack.encode(r,this._msgOptions)};d.call(this,this._rtmClient,i,n,e)}},{key:"getUserRooms",value:function(t,e){var n={flag:1,method:"getuserrooms",payload:msgpack.encode({},this._msgOptions)};d.call(this,this._rtmClient,n,function(t,n){if(t)e(t,null);else{var r=n.rooms;if(r){var i=[];return r.forEach(function(t,e){i[e]=new Int64BE(t)}),void e(null,i)}e(null,n)}},t)}},{key:"getOnlineUsers",value:function(t,e,n){var r={uids:t},i={flag:1,method:"getonlineusers",payload:msgpack.encode(r,this._msgOptions)};d.call(this,this._rtmClient,i,function(t,e){if(t)n(t,null);else{var r=e.uids;if(r){var i=[];return r.forEach(function(t,e){i[e]=new Int64BE(t)}),void n(null,i)}n(null,e)}},e)}},{key:"checkUnreadMessage",value:function(t,e){var n={flag:1,method:"checkunreadmsg",payload:msgpack.encode({},this._msgOptions)};d.call(this,this._rtmClient,n,function(t,n){if(t)e(t,null);else{var r=n.uidOfUnreadMessage;if(r){var i=[];r.forEach(function(t,e){i[e]=new Int64BE(t)}),n.uidOfUnreadMessage=i}var o=n.gidOfUnreadGroupMessage;if(o){var s=[];o.forEach(function(t,e){s[e]=new Int64BE(t)}),n.gidOfUnreadGroupMessage=s}e(null,n)}},t)}},{key:"getGroupMessage",value:function(t,e,n,r,i,o,s,a,u){var c={gid:t,num:e,desc:n,page:r};void 0!==i&&(c.localmid=i),void 0!==o&&(c.localid=o),void 0!==s&&(c.mtypes=s);var f={flag:1,method:"getgroupmsg",payload:msgpack.encode(c,this._msgOptions)};d.call(this,this._rtmClient,f,function(t,e){if(t)u(t,null);else{var n=e.msgs;if(n){var r=[];n.forEach(function(t,e){r[e]={id:new Int64BE(t[0]),from:new Int64BE(t[1]),mtype:Number(t[2]),ftype:Number(t[3]),mid:new Int64BE(t[4]),msg:t[5],attrs:t[6],mtime:Number(t[7])}}),e.msgs=r}u(null,e)}},a)}},{key:"getRoomMessage",value:function(t,e,n,r,i,o,s,a,u){var c={rid:t,num:e,desc:n,page:r};void 0!==i&&(c.localmid=i),void 0!==o&&(c.localid=o),void 0!==s&&(c.mtypes=s);var f={flag:1,method:"getroommsg",payload:msgpack.encode(c,this._msgOptions)};d.call(this,this._rtmClient,f,function(t,e){if(t)u(t,null);else{var n=e.msgs;if(n){var r=[];n.forEach(function(t,e){r[e]={id:new Int64BE(t[0]),from:new Int64BE(t[1]),mtype:Number(t[2]),ftype:Number(t[3]),mid:new Int64BE(t[4]),msg:t[5],attrs:t[6],mtime:Number(t[7])}}),e.msgs=r}u(null,e)}},a)}},{key:"getBroadcastMessage",value:function(t,e,n,r,i,o,s,a){var u={num:t,desc:e,page:n};void 0!==r&&(u.localmid=r),void 0!==i&&(u.localid=i),void 0!==o&&(u.mtypes=o);var c={flag:1,method:"getbroadcastmsg",payload:msgpack.encode(u,this._msgOptions)};d.call(this,this._rtmClient,c,function(t,e){if(t)a(t,null);else{var n=e.msgs;if(n){var r=[];n.forEach(function(t,e){r[e]={id:new Int64BE(t[0]),from:new Int64BE(t[1]),mtype:Number(t[2]),ftype:Number(t[3]),mid:new Int64BE(t[4]),msg:t[5],attrs:t[6],mtime:Number(t[7])}}),e.msgs=r}a(null,e)}},s)}},{key:"getP2PMessage",value:function(t,e,n,r,i,o,s,a,u,c){var f={ouid:t,num:e,direction:n,desc:r,page:i};void 0!==o&&(f.localmid=o),void 0!==s&&(f.localid=s),void 0!==a&&(f.mtypes=a);var l={flag:1,method:"getp2pmsg",payload:msgpack.encode(f,this._msgOptions)};d.call(this,this._rtmClient,l,function(t,e){if(t)c(t,null);else{var n=e.msgs;if(n){var r=[];n.forEach(function(t,e){r[e]={id:new Int64BE(t[0]),direction:Number(t[1]),mtype:Number(t[2]),ftype:Number(t[3]),mid:new Int64BE(t[4]),msg:t[5],attrs:t[6],mtime:Number(t[7])}}),e.msgs=r}c(null,e)}},u)}},{key:"addDevice",value:function(t,e,n,r){var i={apptype:t,devicetoken:e},o={flag:1,method:"adddevice",payload:msgpack.encode(i,this._msgOptions)};d.call(this,this._rtmClient,o,r,n)}},{key:"removeDevice",value:function(t,e,n){var r={devicetoken:t},i={flag:1,method:"removedevice",payload:msgpack.encode(r,this._msgOptions)};d.call(this,this._rtmClient,i,n,e)}},{key:"setTranslationLanguage",value:function(t,e,n){var r={lang:t},i={flag:1,method:"setlang",payload:msgpack.encode(r,this._msgOptions)};d.call(this,this._rtmClient,i,n,e)}},{key:"translate",value:function(t,e,n,r,i){var o={text:t,dst:n};void 0!==e&&(o.src=e);var s={flag:1,method:"translate",payload:msgpack.encode(o,this._msgOptions)};d.call(this,this._rtmClient,s,i,r)}},{key:"setGeo",value:function(t,e,n,r){var i={lat:t,lng:e},o={flag:1,method:"setgeo",payload:msgpack.encode(i,this._msgOptions)};d.call(this,this._rtmClient,o,r,n)}},{key:"getGeo",value:function(t,e){var n={flag:1,method:"getgeo",payload:msgpack.encode({},this._msgOptions)};d.call(this,this._rtmClient,n,e,t)}},{key:"getGeos",value:function(t,e,n){var r={uids:t},i={flag:1,method:"getgeos",payload:msgpack.encode(r,this._msgOptions)};d.call(this,this._rtmClient,i,function(t,e){if(t)n(t,null);else{var r=e.geos;if(r){var i=[];return r.forEach(function(t,e){t[0]=new Int64BE(t[0]),i[e]=t}),void n(null,i)}n(null,e)}},e)}},{key:"sendFile",value:function(t,e,n,r,i){var o={cmd:"sendfile",mtype:t,to:e,file:n};l.call(this,o,i,r)}},{key:"sendFiles",value:function(t,e,n,r,i){var o={cmd:"sendfiles",mtype:t,tos:e,file:n};l.call(this,o,i,r)}},{key:"sendGroupFile",value:function(t,e,n,r,i){var o={cmd:"sendgroupfile",mtype:t,gid:e,file:n};l.call(this,o,i,r)}},{key:"sendRoomFile",value:function(t,e,n,r,i){var o={cmd:"sendroomfile",mtype:t,rid:e,file:n};l.call(this,o,i,r)}},{key:"processor",get:function(){return this._processor}},{key:"rtmConfig",get:function(){return s}}]),t}();function l(t,n,r){var i=this,s=new FileReader;s.onload=function(s){t.fileContent=e.from(s.target.result),t.fileContent?function(t,e,n){var r={cmd:t.cmd};void 0!==t.tos&&(r.tos=t.tos);void 0!==t.to&&(r.to=t.to);void 0!==t.rid&&(r.rid=t.rid);void 0!==t.gid&&(r.gid=t.gid);var i={flag:1,method:"filetoken",payload:msgpack.encode(r,this._msgOptions)};d.call(this,this._rtmClient,i,e,n)}.call(i,t,function(e,s){if(e)i.emit("error",e);else{var a=s.token,u=s.endpoint,c=null;if(!c){var f=t.file.name.lastIndexOf(".");f>0&&f<t.file.name.length-1&&(c=t.file.name.slice(f+1))}var l=p.call(i,p.call(i,t.fileContent)+":"+a),_=new o({endpoint:g.call(i,u),autoReconnect:!1,connectionTimeout:r,proxy:i._proxy});_.connect(),_.on("connect",function(){var e={method:t.cmd,token:a,from:i._uid,mtype:t.mtype,sign:l,ext:c,data:t.fileContent};void 0!==t.tos&&(e.tos=t.tos),void 0!==t.to&&(e.to=t.to),void 0!==t.rid&&(e.rid=t.rid),void 0!==t.gid&&(e.gid=t.gid),function(t,e,n,r){var i={pid:this._pid,token:e.token,mtype:e.mtype,from:e.from,to:e.to,mid:h.call(this),file:e.data,attrs:JSON.stringify({sign:e.sign,ext:e.ext})},o={flag:1,method:e.method,payload:msgpack.encode(i,this._msgOptions)};d.call(this,t,o,n,r)}.call(i,_,e,n,r)}),_.on("error",function(t){i.emit("error",new Error("file client: "+t.message))})}},r):i.emit("error",new Error("no file content!"))},s.readAsArrayBuffer(t.file)}function h(){return++this._midSeq>=999&&(this._midSeq=0),new Int64BE(Date.now().toString()+this._midSeq)}function p(t){return c(t)}function _(t){return t?t instanceof Error?t:t.hasOwnProperty("code")&&t.hasOwnProperty("ex")?new Error("code: "+t.code+", ex: "+t.ex):null:null}function d(t,e,n,r){var i=this;t.sendQuest(e,function(t){if(n){var e=null;if(t.payload){var r=msgpack.decode(t.payload,i._msgOptions);return(e=_.call(i,r))?void n(e,null):void n(null,r)}(e=_.call(i,t))?n(t,null):n(null,t)}},r)}function g(t){if(this._proxy)return t;var e="ws://";return this._ssl&&(e="wss://"),e+t+"/service/websocket"}function m(){if(this._autoReconnect&&!this._reconnectID&&!this._isClose){var t=this;this._reconnectID=setTimeout(function(){t.login(t._endpoint,t._ipv6)},100)}}t.exports=f}).call(this,n(2).Buffer)}]);
//# sourceMappingURL=rtm.min.js.map